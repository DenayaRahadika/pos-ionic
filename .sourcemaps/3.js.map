{"version":3,"sources":["../../src/pages/map-generic/map-generic.module.ts","../../src/pages/map-generic/map-generic.ts"],"names":[],"mappings":"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","file":"3.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MapGenericPage } from './map-generic';\n\n@NgModule({\n  declarations: [\n    MapGenericPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(MapGenericPage),\n  ],\n})\nexport class MapGenericPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/map-generic/map-generic.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, Loading, LoadingController, AlertController } from 'ionic-angular';\n\nimport { LoginService } from '../../providers/login.service';\nimport { Storage } from '@ionic/storage';\nimport { Network } from '@ionic-native/network';\n\ndeclare var google;\n\n@IonicPage()\n@Component({\n  selector: 'page-map-generic',\n  templateUrl: 'map-generic.html',\n})\nexport class MapGenericPage {\n\n  map: any;\n  bounds: any = null;\n  myLatLng: any;\n  waypoints: any[];\n  load: Loading;\n  vendedores: any = {};\n  infowindow: any;\n\n  constructor(\n    private loadCtrl: LoadingController,\n    public alertCtrl: AlertController,\n    private loginService: LoginService,\n    private storage: Storage,\n    private network: Network\n  ) {\n    this.bounds = new google.maps.LatLngBounds();\n    this.infowindow = new google.maps.InfoWindow();\n   }\n\n  ionViewDidLoad() {\n    this.load = this.loadCtrl.create({\n      content: 'Cargando...'\n    });\n    this.load.present();\n    this.verificarInternet();\n    this.loadMap();\n  }\n\n  private verificarInternet(){\n    if (this.network.type === 'none') {\n      console.log(this.network.type);\n      const alert = this.alertCtrl.create({\n        title: 'Sin conexiÃ³n',\n        subTitle: 'Mapa sin actualizar',\n        buttons: ['OK']\n      });\n      alert.present();\n    }\n  }\n\n  private loadMap() {\n    // create a new map by passing HTMLElement\n    const mapEle: HTMLElement = document.getElementById('map');\n\n    const latitud = -17.2378799;\n    const longitud = -66.7239997;\n\n    // create LatLng object\n    const myLatLng = { lat: latitud, lng: longitud };\n    // create map\n    this.map = new google.maps.Map(mapEle, {\n      center: myLatLng,\n      zoom: 12\n    });\n\n    google.maps.event.addListenerOnce(this.map, 'idle', () => {\n      mapEle.classList.add('show-map');\n      this.obtenerVendedores();\n    });\n   }\n\n  private obtenerVendedores() {\n    let lat: number;\n    let lng: number;\n    let title: string;\n    this.loginService.getVendedorAllOnlineRealtimeoOb()\n    .subscribe(vendedor => {\n      if (vendedor) {\n        console.log(vendedor);\n        if (!this.vendedores[vendedor.imei]) {\n          this.vendedores[vendedor.imei] = {};\n          this.vendedores[vendedor.imei].info = vendedor;\n          lat = vendedor.latitud;\n          lng = vendedor.longitud;\n          title = vendedor.nombreVendedor;\n          const icon = './assets/imgs/vendedor.png';\n          this.vendedores[vendedor.imei].marker = this.createMarker(lat, lng, icon, title);\n        }else {\n          this.vendedores[vendedor.imei].info = vendedor;\n          lat = vendedor.latitud;\n          lng = vendedor.longitud;\n          this.vendedores[vendedor.imei].marker.setPosition({\n            lat: lat,\n            lng: lng\n          });\n        }\n        this.fixBounds(lat, lng);\n      }\n    });\n    // this.storage.get('imei')\n    // .then(imei=>{\n    const imei = '358239057387500';\n    this.loginService.getVendedorAllOnlineRealtime(imei);\n    // })\n    this.load.dismiss();\n  }\n\n  private createMarker(lat: number, lng: number, icon: string, title: string) {\n    const options = {\n      position: {\n        lat: lat,\n        lng: lng\n      },\n      title: title,\n      map: this.map,\n      icon: icon\n      // zIndex: (Math.round(lat * -100000)<<5)\n    };\n    const marker = new google.maps.Marker(options);\n\n    marker.addListener('click', () => {\n      this.infowindow.setContent(title);\n      this.infowindow.open(this.map, marker);\n    });\n    \n    return marker;\n  }\n\n  private fixBounds(lat: number, lng: number) {\n    const point = new google.maps.LatLng(lat, lng);\n    this.bounds.extend(point);\n    this.map.fitBounds(this.bounds);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/map-generic/map-generic.ts"],"sourceRoot":""}