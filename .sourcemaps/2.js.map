{"version":3,"sources":["../../src/pages/map-generic/map-generic.module.ts","../../src/pages/map-generic/map-generic.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAyC;AACO;AACD;AAU/C,IAAa,oBAAoB;IAAjC;IAAmC,CAAC;IAAD,2BAAC;AAAD,CAAC;AAAvB,oBAAoB;IARhC,uEAAQ,CAAC;QACR,YAAY,EAAE;YACZ,oEAAc;SACf;QACD,OAAO,EAAE;YACP,sEAAe,CAAC,QAAQ,CAAC,oEAAc,CAAC;SACzC;KACF,CAAC;GACW,oBAAoB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;ACZS;AAC4B;AAET;AACpB;AASzC,IAAa,cAAc;IAUzB,wBACU,QAA2B,EAC3B,YAA0B,EAC1B,OAAgB;QAFhB,aAAQ,GAAR,QAAQ,CAAmB;QAC3B,iBAAY,GAAZ,YAAY,CAAc;QAC1B,YAAO,GAAP,OAAO,CAAS;QAV1B,WAAM,GAAQ,IAAI,CAAC;QAInB,eAAU,GAAQ,EAAE,CAAC;QAQnB,IAAI,CAAC,MAAM,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC;QAC7C,IAAI,CAAC,UAAU,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;QAC/C,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;IAC5B,CAAC;IAEF,uCAAc,GAAd;QACE,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;QACzB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;YAC/B,OAAO,EAAE,aAAa;SACvB,CAAC,CAAC;QACH,IAAI,CAAC,OAAO,EAAE,CAAC;QACf,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IACtB,CAAC;IAEH,wCAAe,GAAf;QACE,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;IACjC,CAAC;IAED,wCAAe,GAAf;QACE,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC;QAChB,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;IACjC,CAAC;IAEO,gCAAO,GAAf;QAAA,iBAqBI;QApBA,yCAAyC;QACzC,IAAI,MAAM,GAAgB,QAAQ,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAEzD,IAAI,OAAO,GAAG,CAAC,UAAU,CAAC;QAC1B,IAAI,QAAQ,GAAG,CAAC,UAAU,CAAC;QAE3B,uBAAuB;QACvB,IAAI,QAAQ,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,QAAQ,EAAE,CAAC;QAE/C,aAAa;QACb,IAAI,CAAC,GAAG,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE;YACrC,MAAM,EAAE,QAAQ;YAChB,IAAI,EAAE,EAAE;SACT,CAAC,CAAC;QAEH,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,EAAE;YAClD,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;YACjC,KAAI,CAAC,iBAAiB,EAAE,CAAC;QAE3B,CAAC,CAAC,CAAC;IACJ,CAAC;IAEM,0CAAiB,GAAzB;QAAA,iBAiCC;QAhCC,IAAI,GAAW,CAAC;QAChB,IAAI,GAAW,CAAC;QAChB,IAAI,KAAa,CAAC;QAClB,IAAI,CAAC,YAAY,CAAC,+BAA+B,EAAE;aAClD,SAAS,CAAC,kBAAQ;YACjB,EAAE,EAAC,QAAQ,CAAC,EAAC;gBACX,EAAE,EAAC,CAAC,KAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,EAAC;oBAClC,KAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;oBACpC,KAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,GAAG,QAAQ,CAAC;oBAC/C,GAAG,GAAG,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC;oBACtC,GAAG,GAAG,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC;oBACvC,KAAK,GAAG,QAAQ,CAAC,cAAc,CAAC;oBAChC,IAAI,IAAI,GAAG,4BAA4B,CAAC;oBACxC,KAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,KAAI,CAAC,YAAY,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;gBACnF,CAAC;gBAAA,IAAI,EAAC;oBACJ,KAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,GAAG,QAAQ,CAAC;oBAC/C,GAAG,GAAG,QAAQ,CAAC,cAAc,CAAC,OAAO,CAAC;oBACtC,GAAG,GAAG,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC;oBACvC,KAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC;wBAChD,GAAG,EAAE,GAAG;wBACR,GAAG,EAAE,GAAG;qBACT,CAAC,CAAC;gBACL,CAAC;gBACD,KAAI,CAAC,SAAS,CAAC,GAAG,EAAC,GAAG,CAAC,CAAC;YAC1B,CAAC;QACH,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC;aACvB,IAAI,CAAC,cAAI;YACR,gCAAgC;YAChC,KAAI,CAAC,YAAY,CAAC,4BAA4B,CAAC,IAAI,CAAC,CAAC;QACvD,CAAC,CAAC;QACF,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IACtB,CAAC;IAEO,qCAAY,GAApB,UAAqB,GAAW,EAAE,GAAW,EAAE,IAAY,EAAE,KAAa;QAA1E,iBAmBC;QAlBC,IAAI,OAAO,GAAG;YACZ,QAAQ,EAAE;gBACR,GAAG,EAAE,GAAG;gBACR,GAAG,EAAE,GAAG;aACT;YACD,KAAK,EAAE,KAAK;YACZ,GAAG,EAAE,IAAI,CAAC,GAAG;YACb,IAAI,EAAE,IAAI;YACV,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,GAAC,CAAC,MAAM,CAAC,IAAE,CAAC;SACnC;QACD,IAAI,MAAM,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAEzC,MAAM,CAAC,WAAW,CAAC,OAAO,EAAE;YAC1B,KAAI,CAAC,UAAU,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;YAClC,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,KAAI,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;QAEP,MAAM,CAAC,MAAM,CAAC;IAChB,CAAC;IAEO,kCAAS,GAAjB,UAAkB,GAAW,EAAE,GAAW;QACxC,IAAM,KAAK,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,EAAC,GAAG,CAAC,CAAC;QAC9C,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAC1B,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAClC,CAAC;IAEH,qBAAC;AAAD,CAAC;AA3HY,cAAc;IAL1B,wEAAS,EAAE;IACX,wEAAS,CAAC;QACT,QAAQ,EAAE,kBAAkB;OACG;KAChC,CAAC;uFAYqC;QACb,iEAAY;QACjB,OAAO;AA8G3B;SA3HY,cAAc,gB","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MapGenericPage } from './map-generic';\n\n@NgModule({\n  declarations: [\n    MapGenericPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(MapGenericPage),\n  ],\n})\nexport class MapGenericPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/map-generic/map-generic.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, Loading, LoadingController } from 'ionic-angular';\r\n\r\nimport { LoginService } from '../../providers/login.service';\r\nimport { Storage } from '@ionic/storage';\r\n\r\ndeclare var google;\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-map-generic',\r\n  templateUrl: 'map-generic.html',\r\n})\r\nexport class MapGenericPage {\r\n\r\n  map: any;\r\n  bounds: any = null;\r\n  myLatLng: any;\r\n  waypoints: any[];\r\n  load: Loading;\r\n  vendedores: any = {};\r\n  infowindow: any;\r\n  \r\n  constructor(\r\n    private loadCtrl: LoadingController,\r\n    private loginService: LoginService,\r\n    private storage: Storage\r\n  ) { \r\n    this.bounds = new google.maps.LatLngBounds();\r\n    this.infowindow = new google.maps.InfoWindow();\r\n    console.log('constructor');\r\n   }\r\n\r\n  ionViewDidLoad() {\r\n    console.log('entro ahi');\r\n    this.load = this.loadCtrl.create({\r\n      content: 'Cargando...'\r\n    });\r\n    this.loadMap();\r\n    this.load.present();\r\n  }\r\n\r\nionViewDidEnter(){\r\n  console.log('entro did enter');\r\n}\r\n\r\nionViewDidLeave(){\r\n  this.map = null;\r\n  console.log('entro did leave');\r\n}\r\n\r\nprivate loadMap(){   \r\n    //create a new map by passing HTMLElement\r\n    let mapEle: HTMLElement = document.getElementById('map');\r\n  \r\n    let latitud = -17.2378799;\r\n    let longitud = -66.7239997;\r\n\r\n    // create LatLng object\r\n    let myLatLng = { lat: latitud, lng: longitud };\r\n    \r\n    // create map\r\n    this.map = new google.maps.Map(mapEle, {\r\n      center: myLatLng,\r\n      zoom: 12\r\n    });\r\n\r\n    google.maps.event.addListenerOnce(this.map, 'idle', () => {\r\n      mapEle.classList.add('show-map');\r\n      this.obtenerVendedores();\r\n      \r\n    });   \r\n   }\r\n\r\n  private obtenerVendedores(){\r\n    let lat: number;\r\n    let lng: number;\r\n    let title: string;\r\n    this.loginService.getVendedorAllOnlineRealtimeoOb()\r\n    .subscribe(vendedor =>{\r\n      if(vendedor){\r\n        if(!this.vendedores[vendedor.imei]){\r\n          this.vendedores[vendedor.imei] = {};\r\n          this.vendedores[vendedor.imei].info = vendedor;\r\n          lat = vendedor.PosicionActual.latitud;\r\n          lng = vendedor.PosicionActual.longitud;\r\n          title = vendedor.nombreVendedor;\r\n          let icon = './assets/imgs/vendedor.png';\r\n          this.vendedores[vendedor.imei].marker = this.createMarker(lat, lng, icon, title);\r\n        }else{\r\n          this.vendedores[vendedor.imei].info = vendedor;\r\n          lat = vendedor.PosicionActual.latitud;\r\n          lng = vendedor.PosicionActual.longitud;\r\n          this.vendedores[vendedor.imei].marker.setPosition({\r\n            lat: lat,\r\n            lng: lng\r\n          });\r\n        }\r\n        this.fixBounds(lat,lng);\r\n      }\r\n    });\r\n    this.storage.get('imei')\r\n    .then(imei=>{\r\n      // let imei = '357815085654648';\r\n      this.loginService.getVendedorAllOnlineRealtime(imei);\r\n    })\r\n    this.load.dismiss();\r\n  }\r\n  \r\n  private createMarker(lat: number, lng: number, icon: string, title: string){\r\n    let options = {\r\n      position: {\r\n        lat: lat,\r\n        lng: lng\r\n      },\r\n      title: title,\r\n      map: this.map,\r\n      icon: icon,\r\n      zIndex: Math.round(lat*-100000)<<5\r\n    }\r\n    let marker = new google.maps.Marker(options);\r\n    \r\n        marker.addListener('click', ()=>{\r\n          this.infowindow.setContent(title); \r\n          this.infowindow.open(this.map, marker);\r\n        }); \r\n\r\n    return marker;\r\n  }\r\n\r\n  private fixBounds(lat: number, lng: number){\r\n    const point = new google.maps.LatLng(lat,lng);\r\n    this.bounds.extend(point);\r\n    this.map.fitBounds(this.bounds);\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/map-generic/map-generic.ts"],"sourceRoot":""}