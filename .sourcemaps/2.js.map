{"version":3,"sources":["../../src/pages/map-generic/map-generic.module.ts","../../src/pages/map-generic/map-generic.ts"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MapGenericPage } from './map-generic';\n\n@NgModule({\n  declarations: [\n    MapGenericPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(MapGenericPage),\n  ],\n})\nexport class MapGenericPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/map-generic/map-generic.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, Loading, LoadingController, AlertController } from 'ionic-angular';\r\n\r\nimport { LoginService } from '../../providers/login.service';\r\nimport { Storage } from '@ionic/storage';\r\nimport { Network } from '@ionic-native/network';\r\n\r\ndeclare var google;\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-map-generic',\r\n  templateUrl: 'map-generic.html',\r\n})\r\nexport class MapGenericPage {\r\n\r\n  map: any;\r\n  bounds: any = null;\r\n  myLatLng: any;\r\n  waypoints: any[];\r\n  load: Loading;\r\n  vendedores: any = {};\r\n  infowindow: any;\r\n\r\n  constructor(\r\n    private loadCtrl: LoadingController,\r\n    public alertCtrl: AlertController,\r\n    private loginService: LoginService,\r\n    private storage: Storage,\r\n    private network: Network\r\n  ) {\r\n    this.bounds = new google.maps.LatLngBounds();\r\n    this.infowindow = new google.maps.InfoWindow();\r\n   }\r\n\r\n  ionViewDidLoad() {\r\n    this.load = this.loadCtrl.create({\r\n      content: 'Cargando...'\r\n    });\r\n    this.load.present();\r\n    this.verificarInternet();\r\n    this.loadMap();\r\n  }\r\n\r\n  private verificarInternet(){\r\n    if (this.network.type === 'none') {\r\n      console.log(this.network.type);\r\n      const alert = this.alertCtrl.create({\r\n        title: 'Sin conexiÃ³n',\r\n        subTitle: 'Mapa sin actualizar',\r\n        buttons: ['OK']\r\n      });\r\n      alert.present();\r\n      this.load.dismiss();\r\n    }\r\n  }\r\n\r\n  private loadMap() {\r\n    // create a new map by passing HTMLElement\r\n    const mapEle: HTMLElement = document.getElementById('map');\r\n\r\n    const latitud = -17.2378799;\r\n    const longitud = -66.7239997;\r\n\r\n    // create LatLng object\r\n    const myLatLng = { lat: latitud, lng: longitud };\r\n    // create map\r\n    this.map = new google.maps.Map(mapEle, {\r\n      center: myLatLng,\r\n      zoom: 12\r\n    });\r\n\r\n    google.maps.event.addListenerOnce(this.map, 'idle', () => {\r\n      mapEle.classList.add('show-map');\r\n      this.obtenerVendedores();\r\n    });\r\n   }\r\n\r\n  private obtenerVendedores() {\r\n    let lat: number;\r\n    let lng: number;\r\n    let title: string;\r\n    this.loginService.getVendedorAllOnlineRealtimeoOb()\r\n    .subscribe(vendedor => {\r\n      if (vendedor) {\r\n        console.log(vendedor);\r\n        if (!this.vendedores[vendedor.imei]) {\r\n          this.vendedores[vendedor.imei] = {};\r\n          this.vendedores[vendedor.imei].info = vendedor;\r\n          lat = vendedor.latitud;\r\n          lng = vendedor.longitud;\r\n          title = vendedor.nombreVendedor;\r\n          const icon = './assets/imgs/vendedor.png';\r\n          this.vendedores[vendedor.imei].marker = this.createMarker(lat, lng, icon, title);\r\n        }else {\r\n          this.vendedores[vendedor.imei].info = vendedor;\r\n          lat = vendedor.latitud;\r\n          lng = vendedor.longitud;\r\n          this.vendedores[vendedor.imei].marker.setPosition({\r\n            lat: lat,\r\n            lng: lng\r\n          });\r\n        }\r\n        this.fixBounds(lat, lng);\r\n      }\r\n    });\r\n    // this.storage.get('imei')\r\n    // .then(imei=>{\r\n    const imei = '356812072377714';\r\n    this.loginService.getVendedorAllOnlineRealtime(imei);\r\n    // })\r\n    this.load.dismiss();\r\n  }\r\n\r\n  private createMarker(lat: number, lng: number, icon: string, title: string) {\r\n    const options = {\r\n      position: {\r\n        lat: lat,\r\n        lng: lng\r\n      },\r\n      title: title,\r\n      map: this.map,\r\n      icon: icon\r\n      // zIndex: (Math.round(lat * -100000)<<5)\r\n    };\r\n    const marker = new google.maps.Marker(options);\r\n\r\n    marker.addListener('click', () => {\r\n      this.infowindow.setContent(title);\r\n      this.infowindow.open(this.map, marker);\r\n    });\r\n    \r\n    return marker;\r\n  }\r\n\r\n  private fixBounds(lat: number, lng: number) {\r\n    const point = new google.maps.LatLng(lat, lng);\r\n    this.bounds.extend(point);\r\n    this.map.fitBounds(this.bounds);\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/map-generic/map-generic.ts"],"sourceRoot":""}